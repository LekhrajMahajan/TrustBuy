import{c as F,R,j as e,u as A,r as i,P as W,p as f,b as O,t as u}from"./index-C-xu5ddY.js";import{P as _}from"./ProductCard-C4u3lKoT.js";import{B as D,T as $}from"./triangle-alert-CTZB9KKE.js";import{L as I}from"./loader-circle-DVf1jROQ.js";import"./zap-CMWhSjSV.js";import"./star-Bdx35W03.js";const J=[["path",{d:"M10 12h4",key:"a56b0p"}],["path",{d:"M10 8h4",key:"1sr2af"}],["path",{d:"M14 21v-3a2 2 0 0 0-4 0v3",key:"1rgiei"}],["path",{d:"M6 10H4a2 2 0 0 0-2 2v7a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-2",key:"secmi2"}],["path",{d:"M6 21V5a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v16",key:"16ra0t"}]],H=F("building-2",J);class V extends R.Component{constructor(a){super(a),this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(a){return{hasError:!0}}componentDidCatch(a,c){this.setState({error:a,errorInfo:c}),console.error("ErrorBoundary caught an error",a,c)}render(){return this.state.hasError?e.jsxs("div",{className:"p-4 bg-red-50 border border-red-200 rounded text-red-800 m-4",children:[e.jsx("h2",{className:"text-lg font-bold",children:"Something went wrong rendering this component."}),e.jsx("p",{className:"font-mono text-xs mt-2",children:this.state.error&&this.state.error.toString()}),e.jsx("details",{className:"mt-2 text-xs whitespace-pre-wrap text-gray-600 dark:text-gray-400",children:this.state.errorInfo&&this.state.errorInfo.componentStack})]}):this.props.children}}const X=()=>{const{user:g}=A(),a=g?.sellerStats?.status||"pending",c=g?.sellerStats?.businessName,[p,h]=i.useState(!1),[w,E]=i.useState([]),[M,S]=i.useState(!0),[m,b]=i.useState(!1),[j,P]=i.useState("url"),[y,v]=i.useState(null),[s,l]=i.useState({name:"",category:"Mobile",basePrice:"",description:"",stock:"",image:""}),[d,k]=i.useState({businessName:"",gstin:"",pickupAddress:""}),N=async()=>{try{const t=await f.getMyProducts();Array.isArray(t)&&(E(t),t.length===0&&h(!0))}catch(t){console.error(t)}finally{S(!1)}};i.useEffect(()=>{a==="active"?N():S(!1)},[a]);const{checkUserStatus:C}=A();i.useEffect(()=>{a==="pending"&&c&&C()},[a,c,C]);const B=async t=>{t.preventDefault(),b(!0);try{const r=await O.registerSeller(d),x=JSON.parse(localStorage.getItem("userInfo"));x&&(x.sellerStats=r.sellerStats,localStorage.setItem("userInfo",JSON.stringify(x))),u.success("Application Submitted successfully!"),setTimeout(()=>window.location.reload(),1e3)}catch(r){console.error(r),u.error("Application Failed")}finally{b(!1)}},L=t=>{const r=t.target.files[0];if(r){const x=new FileReader;x.onloadend=()=>l({...s,image:x.result}),x.readAsDataURL(r)}},T=async t=>{t.preventDefault(),b(!0);try{const r={...s,image:s.image||"https://via.placeholder.com/300",currentPrice:s.basePrice};y?(await f.updateProduct(y,r),u.success("Product Updated")):(await f.createProduct(r),u.success("Product Listed")),l({name:"",category:"Mobile",basePrice:"",description:"",stock:"",image:""}),v(null),h(!1),N()}catch(r){console.error(r),u.error("Operation failed")}finally{b(!1)}},U=t=>{u("Delete Product?",{action:{label:"Delete",onClick:async()=>{await f.deleteProduct(t),u.success("Deleted"),N()}}})},q=t=>{l({...t,image:t.image}),v(t._id),h(!0),window.scrollTo({top:0,behavior:"smooth"})},o="w-full border-b border-gray-200 dark:border-gray-700 py-3 text-sm focus:border-black dark:border-white focus:outline-none bg-transparent placeholder:text-gray-400",n="text-xs font-bold uppercase tracking-wider text-gray-500 dark:text-gray-400";return e.jsx("div",{className:"min-h-screen bg-white dark:bg-gray-900 pt-24 pb-12",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-end justify-between mb-12 gap-6 border-b border-gray-100 dark:border-gray-800 pb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-4xl font-extrabold text-black dark:text-white tracking-tight uppercase",children:"Dashboard"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-2",children:"Manage your collection and inventory."})]}),a==="active"?e.jsx("button",{onClick:()=>{p&&(l({name:"",category:"Mobile",basePrice:"",description:"",stock:"",image:""}),v(null)),h(!p)},className:`px-6 py-3 rounded-full text-xs font-bold uppercase tracking-widest transition-all ${p?"bg-gray-200 dark:bg-gray-700 text-black dark:text-white hover:bg-gray-300":"bg-black dark:bg-gray-800 text-white dark:text-white hover:bg-gray-800"}`,children:p?"Cancel":"+ Add Product"}):e.jsxs("div",{className:"flex items-center gap-2 px-6 py-3 rounded-full text-xs font-bold uppercase tracking-widest bg-gray-100 dark:bg-gray-800 text-gray-500 dark:text-gray-400 cursor-not-allowed",children:[a==="suspended"?e.jsx(D,{className:"w-4 h-4"}):e.jsx(I,{className:"w-4 h-4"}),a==="suspended"?"Account Suspended":"Approval Pending"]})]}),a==="pending"&&!c&&e.jsxs("div",{className:"max-w-2xl mx-auto bg-gray-50 dark:bg-gray-950 p-8 rounded-xl border border-gray-100 dark:border-gray-800 mb-12 text-center",children:[e.jsx(H,{className:"w-12 h-12 mx-auto mb-4 text-gray-400"}),e.jsx("h2",{className:"text-2xl font-bold mb-2",children:"Become a Seller"}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mb-8 max-w-md mx-auto",children:"Complete your business profile to start selling on TrustBuy. Our team reviews all applications within 24 hours."}),e.jsxs("form",{onSubmit:B,className:"text-left space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:n,children:"Business Name"}),e.jsx("input",{type:"text",required:!0,className:o,placeholder:"e.g. Urban Threads Inc.",value:d.businessName,onChange:t=>k({...d,businessName:t.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:n,children:"GSTIN / Tax ID"}),e.jsx("input",{type:"text",required:!0,className:o,placeholder:"e.g. 29ABCDE1234F1Z5",value:d.gstin,onChange:t=>k({...d,gstin:t.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:n,children:"Pickup Address"}),e.jsx("textarea",{rows:"3",required:!0,className:o,placeholder:"Warehouse address...",value:d.pickupAddress,onChange:t=>k({...d,pickupAddress:t.target.value})})]}),e.jsx("button",{type:"submit",disabled:m,className:"w-full bg-black dark:bg-gray-800 text-white dark:text-white py-4 rounded-lg font-bold uppercase tracking-widest text-xs hover:bg-gray-800 transition-colors",children:m?"Submitting Application...":"Submit Application"})]})]}),a==="pending"&&c&&e.jsxs("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-8 mb-12 rounded-r-lg text-center",children:[e.jsx($,{className:"h-8 w-8 text-yellow-400 mx-auto mb-4","aria-hidden":"true"}),e.jsx("h3",{className:"text-lg font-bold text-yellow-800 mb-2",children:"Application Under Review"}),e.jsxs("p",{className:"text-yellow-700 max-w-xl mx-auto",children:["We received your seller application. An administrator will verify your details (",g.sellerStats.businessName,") shortly. Once approved, you can start listing products immediately."]})]}),a==="suspended"&&e.jsx("div",{className:"bg-red-50 border-l-4 border-red-400 p-4 mb-8 rounded-r-lg",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx(D,{className:"h-5 w-5 text-red-400","aria-hidden":"true"})}),e.jsx("div",{className:"ml-3",children:e.jsxs("p",{className:"text-sm text-red-700",children:[e.jsx("strong",{children:"Account Suspended."})," Please contact support to resolve this issue."]})})]})}),a==="active"&&e.jsx("div",{className:`overflow-hidden transition-all duration-500 ease-in-out ${p?"max-h-[1000px] opacity-100 mb-16":"max-h-0 opacity-0"}`,children:e.jsxs("div",{className:"bg-gray-50 dark:bg-gray-950 p-8 md:p-12 rounded-xl",children:[e.jsx("h2",{className:"text-2xl font-bold mb-8",children:y?"Edit Item":"New Listing"}),e.jsxs("form",{onSubmit:T,className:"grid md:grid-cols-2 gap-12",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:n,children:"Product Name"}),e.jsx("input",{type:"text",required:!0,className:o,value:s.name,onChange:t=>l({...s,name:t.target.value}),placeholder:"e.g. Leather Crossbody Bag"})]}),e.jsxs("div",{children:[e.jsx("label",{className:n,children:"Category"}),e.jsxs("select",{className:o,value:s.category,onChange:t=>l({...s,category:t.target.value}),children:[e.jsx("option",{children:"Mobile"}),e.jsx("option",{children:"Laptops"}),e.jsx("option",{children:"Audio"}),e.jsx("option",{children:"Bags"}),e.jsx("option",{children:"Shoes"}),e.jsx("option",{children:"Watches"}),e.jsx("option",{children:"Denim"}),e.jsx("option",{children:"Jackets"}),e.jsx("option",{children:"Men's Wear"}),e.jsx("option",{children:"Women's Wear"}),e.jsx("option",{children:"Accessories"}),e.jsx("option",{children:"Electronics"}),e.jsx("option",{children:"Fashion"}),e.jsx("option",{children:"Home"}),e.jsx("option",{children:"Beauty"}),e.jsx("option",{children:"Sports"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:n,children:"Price (â‚¹)"}),e.jsx("input",{type:"number",required:!0,className:o,value:s.basePrice,onChange:t=>l({...s,basePrice:t.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:n,children:"Stock Qty"}),e.jsx("input",{type:"number",required:!0,className:o,value:s.stock,onChange:t=>l({...s,stock:t.target.value})})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:n,children:"Image"}),e.jsxs("div",{className:"flex gap-2 mt-2 mb-2",children:[e.jsx("button",{type:"button",onClick:()=>P("url"),className:`text-[10px] uppercase font-bold tracking-widest px-3 py-1.5 rounded transition-colors ${j==="url"?"bg-black dark:bg-gray-800 text-white dark:text-white":"bg-gray-200 dark:bg-gray-700 text-gray-600 dark:text-gray-400 hover:bg-gray-300"}`,children:"URL"}),e.jsx("button",{type:"button",onClick:()=>P("file"),className:`text-[10px] uppercase font-bold tracking-widest px-3 py-1.5 rounded transition-colors ${j==="file"?"bg-black dark:bg-gray-800 text-white dark:text-white":"bg-gray-200 dark:bg-gray-700 text-gray-600 dark:text-gray-400 hover:bg-gray-300"}`,children:"Upload"})]}),j==="url"?e.jsx("input",{type:"url",className:o,placeholder:"https://...",value:s.image,onChange:t=>l({...s,image:t.target.value})}):e.jsx("input",{type:"file",className:"block w-full text-sm text-gray-500 dark:text-gray-400 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-xs file:font-bold file:uppercase file:bg-black dark:bg-gray-800 file:text-white dark:text-white hover:file:bg-[#fdc600] hover:file:text-black transition-all cursor-pointer",accept:"image/*",onChange:L})]}),e.jsxs("div",{children:[e.jsx("label",{className:n,children:"Description"}),e.jsx("textarea",{rows:"3",required:!0,className:o,value:s.description,onChange:t=>l({...s,description:t.target.value}),placeholder:"Product details..."})]}),e.jsx("div",{className:"pt-4 flex justify-end",children:e.jsx("button",{type:"submit",disabled:m,className:"bg-[#fdc600] text-black dark:text-black px-8 py-3 rounded-full font-bold text-sm uppercase tracking-widest hover:bg-yellow-500 transition-colors shadow-lg",children:m?"Processing...":y?"Save Changes":"Publish Listing"})})]})]})]})}),M?e.jsx("div",{className:"flex justify-center py-20",children:e.jsx(I,{className:"w-8 h-8 animate-spin"})}):a==="active"&&w.length===0?e.jsxs("div",{className:"text-center py-32 bg-gray-50 dark:bg-gray-950 rounded-lg",children:[e.jsx(W,{className:"w-12 h-12 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-gray-100",children:"Your collection is empty."}),e.jsx("p",{className:"text-gray-500 dark:text-gray-400 mt-2",children:"Start selling by adding your first product."})]}):a==="active"&&e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-x-6 gap-y-12",children:w.map(t=>e.jsx(V,{children:e.jsx(_,{product:t,onEdit:q,onDelete:U})},t._id))})]})})};export{X as default};
